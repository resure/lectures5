# Базы данных
*Воронов Александр Николаевич*

Семестр 5, экзамен.

# Литература
- Кузин, Демин "Разработка баз данных в системе Microsoft Access"
- Губарь "Проектирование объектов баз данных в среде Access"
- Дего "Access. Учебно-практическое пособие"

# Методика разработки и применения информационных систем

Контрольные вопросы:

1. Общие сведения об информационных системах
2. Назначение, структура и классификация автоматизированных информационных систем (АИС)
3. Основы создания АИС. Понятие базы данных и банка данных

АИС -- это круто, инфа 100%


## Общие сведения об информационных системах
### Структура информационнной системы
Основной элемент -- информационный фонд, хранящийся в информационной системе. Информация в этом фонде организована. В некоторых системах первоначальный ввод может не предусматриваться.

Эксплуатация ИС связана с выполнением определенных процедур (таких как первоначальный ввод, хранение данных, поиск информации и завершающая обработка информации).

Процедура обновления связана с внесением изменений в информацонный фонд, процедуры поиска и завершающей обработки информации не изменяют содержимого системы, но позволяют работать с ней.

Процедура управления процессом организации хранения и выдачи информации -- ведущая процедура, распознает виды запросов, приводит в действие те или иные процедуры и управляет прочими процессами.


### Информационная система
Это комплекс, состоящий из информационного фонда и следующих процедур: управляющей, обновления, информационного поиска и завершающей обработки информации, позволяющих накапливать, хранить, корректировать и выдавать информацию.

Информационная система включает в себя:

- Носитель информации -- физическая компонента ИС
- Информационный фонд -- информационная компонента ИС
- Набор процедур -- функциональная компонента ИС


### Категории ИС
Информационные системы можно разделить на несколько категорий:

- Ручные ИС (записная книжка и т.д.)
- Механические ИС
- Электронные ИС
- Автоматизированные ИС
- Автоматические ИС

Недостатки традиционных методов обработки информации:

- Низкая оперативность обработки данных
- Низкая точность и недостаточная полнота данных
- Высокая трудоемкость и стоимость преобразования и хранения информации
- Низкое качество самой информации


## Назначение, структура и классификация АИС
АИС воспринимают и обрабатывают информацию об окружающей среде, подготавливают ее и выдают в нужном виде.

### Задачи АИС
- Создание и корректировка информационного фонда при его первоначальном формировании и развитии
- Текущее обновление или модификация информационного фонда в ходе эксплуатации АИС
- Обслуживание запросов при использовании информационного фонда при решении задач управления

Пользователи:
1. Пользователи-люди
2. Пользователи-задачи

### Классификация АИС
Для решения конкретных задач они могут быть условно разделены на следующие типы:

1. Системы информационного обеспечения расчетов
  - Основные пользователи -- расчетные задачи
  - Данные проводятся для научных и инженерных расчетов
  - Пример: информационные базы и программы, обеспечивающие комплексное решение расчетных задач
2. Запросно-справочные системы
  - Основные пользователи -- люди, заинтересованные в заполучении сведений в своей предметной области
  - Автоматизированные информационно-справочные системы
  - Автоматизированные информационно-поисковые системы
    - Документальные -- поиск первичных документов
    - Фактографические -- выборка сведений из документов
3. Системы коллективного пользования
   - Объединяют в себе возможности всех вышеперечисленных систем
   - Отличительные особенности:
    - Результатом функционирования является представление необходимых данных для выработки управляющих воздействий
    - Для этих систем характерно наличие общих информационных массивов, которые потом могут использоваться различными пользователями при решении различных задач
    - Такие системы, как правило, опираются на общую техническую базу
  - Обслуживание заданий:
    - Проверка допуска пользователя
    - Запускается процедура для выполнения запроса
    - После процедуры формируется сообщение, которое передается абоненту

Таким образом АИС служат для удовлетворения информационных потребностей пользователей и для этого они в своем составе должны иметь как минимум две основные компоненты:

1. Информационная компонента
2. Функциональная компонента

## Основы создания АИС, понятие баз и банков данных
Еще в древнем Египте в прошлом веке (60е-70е) в основном использовался файловый подход хранения информации. Данный метод предполагает создание наборов данных, жестко связанных с программами их обработки. Данные хранились в определенных структурах, называемых массивами данных, при изменении которых возникала необходимость внесения изменения в программы обработки данных.

С увеличением объема и структуры обрабатываемой информации выявились недостатки файлового подхода к хранению информации:

1. Неоправданная избыточность хранения данных в массивах
2. Сложность автоматизации процессов ввода, корректировки и выдачи данных
3. Зависимость прикладных программ от изменения информационной базы
4. Жесткая связь данных с программами их обработки
5. Слабое использовании современной вычислительной техники по работе с такими структурами

Концепция баз и банков данных появилась как попытка решения этих проблем.

Сущность концепции баз и банков данных заключается в интеграции данных в единый информационный Фонд и централизованного управления ими для обеспечения многоаспектного последующего их использования многими пользователями при взаимном разделении данных и программ их обработки.

Автоматизированный банк данных представляет собой систему информационных, математических, программных, языковых, организационных и технических, предназначеных для централизованного накопления информации и коллективного многоаспектного использования данных, а также для получения необходимой информации по запросам.

### Особенности централизованного хранения информации в банках данных
1. Сокращение избыточности хранимой информации -- ликвидация дублирования
2. Устранение противоречивости хранимых данных
3. Многоаспектное использование информации
4. Обеспечение возможности стандартизации
5. Обеспечение возможности санкционированного доступа к информации

### Состав банка данных
- Одна или несколько баз данных
- СУБД
- Администратор базы данных
- Словарь данных
- Вычислительная система
- Обслуживающий персонал

База данных -- некоторым образом организованная совокупность данных, которые отображают состояние объектов какой-либо предметной области, а также отношения между этими объектами.

База данных -- совокупность взаимосвязанных хранящихся вместе данных при наличии такой минимальной их избыточности, которая допускает их использование оптимальным образом для одного или нескольких приложений, при этом данные запоминаются так, чтобы они были независимы от программ их обработки, а также были способы к добавлению новых данных и модификации существующих на основе общего управляющего способа.

Свойства базы данных:

- Связанность хранящихся вместе данных
- Минимальная избыточность данных
- Использование одних и тех же данных несколькими пользователями
- Независимость данных от использующих их программ
- Наличие управления данными для ввода, изменения и выборки
- Возможность наращивания информационного фонда
- СУБД

СУБД -- специальный пакет программ, посредством которого реализуется централизованное управление базами данных и обеспечивается корректный доступ к данным.

Основные задачи СУБД:

1. Формирование базы данных
2. Поддержание базы данных в актуальном состоянии, в постоянной готовности к использованию информации, хранящейся в ней
3. Прием и обслуживание запросов в базе данных
4. Завершающая обработка информации
5. Организация совместной работы пользователей
6. Представление информации пользователям в доступном и наглядном виде
7. Обеспечение целостности базы данных
8. Разграничение доступа к базам данных

Администратор базы данных -- лицо или группа лиц, реализующие организационное управление базой данных, причем они могут руководить работами по составлению структуры, выбору ПО и оборудования, подготовки специалистов и т.д.

Основные функции базы данных:

1. Удовлетворение информационных потребностей пользователей
2. Обеспечение возможности хранения и модификации больших объемов информации
3. Обеспечение заданного уровня достоверности хранимой информации и ее непротиворечивости
4. Обеспечение санкционированного доступа к данным
5. Обеспечение возможности поиска информации по произвольной группе признаков
6. Удовлетворение заданным требованиям производительности при обработке запросов
7. Обеспечение возможности реорганизации и расширения границ предметной области для базы данных
8. Обеспечение выдачи информации пользователям в различной форме
9. Обеспечение простоты и удобности обращения пользователей за информацией
10. Обеспечение одновременного обслуживания нескольких пользователей

### Модели представления данных в базе
Формализация информации -- расчленение (декомпозиция) сообщений на отдельные фрагменты, информационные элементы вплоть до атомарных с заменой сложных синтаксических связей между ними простыми формальными логическими связями. Структура сообщения при этом приобретает позиционный характер (например, табличный вид) в котором содержание данных однозначно определяется их местом (позицией в таблице) или специальным признаком этих данных.

Исходной точкой для нормализации информации является ее классификация.

Классификация информации -- совокупность правил распределения множества объектов на подмножества в соответствии с установленными признаками их сходства и различия. Как правило, в системе классификации информации выделяют т.н. однородные объекты, которые характеризуются одинаковым набором свойств или характеристик.

Информация, описывающая эти объекты разделяется на классы, виды, группы, подгруппы и т.д.

Единая система классификации информации в нашей стране предназначена для идентификации понятий, терминов, а также для приведения в порядок информационных объектов, устранения разнородности, неоднозначности и дублирования данных. Существует несколько признаков классификации информации:

- Смысловое содержание данных
- Их принадлежность 
- Детализация по структуре
- Детализация по степени подробности данных

Ядром любой базы данных является некоторая модель даннх, которая представляет собой множество структур данных, их ограничений и операций по манипулированию данными.

С помощью такой модели могут быть представлены любые объекты предметной области, а также взаимосвязи между ними.

В настоящее время существует три основных типа моделей данных:

1. Иерархическая модель
  - Совокупность элементов, связанных между собой по определенным правилам, образующих таким образом ориентированный граф
  - Основные понятия:
    - Уровень
    - Узел -- совокупность атрибутов данных, описывающих некоторый объект. Каждый узел на более низком уровне связан только с одним узлом на более высоком уровне. Таким образом, иерархическое дерево имеет только одну вершину, которая не подчиняется другим узлам
    - Связь
2. Сетевая модель
  - При тех же основных понятиях, каждый элемент может быть связан с любым другим элементом
3. Реляционная — 1970 год, IBM, Эдгар Франк «Тед» Кодд
  - Relation -- отношение
  - Представление данных в виде таблиц
  - Каждая из этих таблиц представляет собой двумерный массив, в котором представлены т.н. тройки:

Свойства:

- Каждый элемент таблицы это один элемент данных
- Все столбцы в таблице однородные
- Каждый столбец имеет уникальное неповторяющееся имя
- В таблице отсутствуют повторяющиеся строки
- Порядок следования строк и столбцов может быть произвольным

Каждая строка -- запись -- кортеж.

Наименования характеристик -- поля.

Атрибут -- атомарный информационный элемент, имеющий имя и значение.

В каждой таблице существует поле, каждое значение которого однозначно определяет все соответствующую запись. Такое поле называется ключем.

Ключи бывают простые и составные.

Для разработки операций по работе с такими данными используется реляционная алгебра.

- Создание таблиц
- Выделение части таблиц
- Создание другой таблицы путем слияния нескольких таблиц
- Изменение содержания хранящихся данных
- Исключение старой информации
- И т.д. и т.п.

Такие операции составляют основу решения информационных задач во всех реляционных базах.

Таким образом, реляционной называют базу данных, в которой накапливается и хранится информация об однородных объектах одной предметной области в форме таблиц.

Операции по работе с данными осуществляются с помощью специального языка, входящего в состав СУБД.

### Кодирование информации
Представление информации в формализованном виде сопряжено с процессом ее кодирования под которым понимается образование и присвоение условных обозначений объектам или классификационным группам в целях придания данным компактной формы для ввода их в систему. Для формирования кодов используется специальный алфавит. Структура такого кода это условное обозначение состава и обозначения знаков в такой форме.

- Понятийные коды
- Системные (машинные) код


- - - -

Банк данных: централизованное управление, коллективное многоаспектное использование, физическая компонента -- электронно-вычислительная машина, информационная -- база данных, функциональная -- СУБД.

Ответственность за нормальное функционирование такой АИС возлагается на администратора банка данных.

# Методика создания АИС с применением СУБД Microsoft Access
(методика разработки БД в системе Access)

Вопросы:

1. Основные характеристики СУБД Access
2. Основные типы объектов базы данных и их характеристика
3. Методика создания базы данных и управления ее компонентами

Microsoft Access является настольной РСУБД, имеющей простой графический интерфейс, позволяет создавать как простые, так и сложные приложения.

DBase, FoxPro, Access являются интерпретаторами, DBase и FoxPro также включают в себя компилятор.

Access хранит все данные в одном файле.

Есть общие и специализированные базы данных: первые ориентируются на использование в различных областях, специализированные создаются для узких областей использования.

Access предназначен для автоматизации процессов производства, учета статистики, накопления и выдачи информации в любой сфере образования, науки и бизнеса.

## Возможности системы Microsoft Access
- Система включает процедуры обработки событий, а также модули форм и отчетов
- В процессе выполнения различных процедур можно настраивать свойства объектов системы (либо встроенными функциями, либо с помощью макросов)
- Модель событий: в системе Access, так же как и в VIsual Basic, существует модель, которая позволяет реагировать на возникновение различных событий (нажатие клавиш, истечение интервала времени, движение курсора)
- В системе Access заложена обработка данных с помощью VBA (Visual Basic for Applications)
- Система имеет построитель меню и создание подменю
- Система Access имеет улучшенные средства отладки кода программ
- Система имеет встроенную систему (процедуру) обработки ошибок. Помимо традиционных способов обработки ошибок, можно использовать процедуры обработки событий «**ERROR АА БЛЯТЬ ОШИБКА**»
- Система имеет улучшенный интерфейс защиты: специальные команды, окна, которые упрощают процедуры аутентификации и т.д.
- Программная поддержка механизмов OLE
- Система имеет возможность создания и настройки различных програм-надстроек


## Состав мастеров Access
Мастер — пошаговое автоматическое выполнение процедуры с помощью которых, не будучи программистом в области Visual Basic, можно построить сложнейшие выражения, не написав ни одной строчки кода.

- Мастер по анализу таблиц (позволяет создавать и редактировать страницы, обрабатывать данные, а также проводить анализ таблиц в базе на предмет соответствия их требованиям, за счет анализа такой информации в таблицах, мы можем их нормализовать)
- Мастер по созданию форм и отчетов
- Мастер подстановок (создает в поле таблицы раскрывающийся список, в котором могут находиться значения из другой таблицы; такой список может использоваться для выбора представленных значений)
- Мастер по импорту и экспорту данных (позволяет просматривать данные при экспорте или импорте из электронных таблиц)
- Мастер защиты (используется для защиты информации в базе данных, при необходимости эвакуирует данные, при этом копируя данные в другое место, снимая с них права пользования и шифруя базу)
- Мастер по разделению базы данных


## Использование других технологий в среде Access

- Полностью совместима со всеми другими компонентами Mirosoft Office
- Access обеспечивает возможность динамического обмена данными
- OLE
- drag-and-drop
- Acess может использовать данные других СУБД
- Acess может использовать файлы, поддерживающие стандарт открытого доступа


## Состав и характеристика основных объектов системы Access
Основные типы объектов:

- Таблица — основное хранилище обрабатываемых данных, основа всех других объектов; объект, предназначенный для хранения данных в виде записей об объектах (в строках таблицы) и в виде полей (столбцов) с характеристиками этих объектов. Таблица — оптимальная структура, которая должна обеспечить:
	- Максимальную скорость доступа к данным
	- Исключение повторения данных в таблице
	- Целостность данных в таблице — создание связей между таблицами, допускающими одновременную модификацию всех данных в связанных таблицах
	- Таблицы, соответствующие приведенным выше требованиям, называют безизбыточными или нормализованными
- Формы
- Запросы
- Отчеты
- Макросы
- Модули
- Страницы

Ограничения при проектировании баз данных и их таблиц:

- Максимальный объем базы данных может составлять до двух гигабайт
- Максимальная длина имени поля не превышает 64 символа
- Максимальное количество полей в одной таблице — не более 255
- Максимальная длина записи — 2 кб
- До двух миллиардов записей

В системе Access возможны три способа создания таблиц:

- Путем ввода данных с помощью мастера
- В режиме конструктора
- Путем изменения данных в таблице

При создании страниц с помощью конструктора существует также ряд ограничений, которые необходимо заполнить:

- Название поля не превышает64 символа
- Каждое имя должно быть уникальным
- В названии нельзя использовать такие символы как ., !, [], ‘
- Имя не должно начинаться с пробела

Эти же правила действуют для всех имен объектов в среде Access.

## Типы данных

- Текстовый тип
- Поле «memo» — поле комментариев, не может содержать более 65535 символов, оно не может быть ключевым или индексным
- Числовой
- Поле-счетчик — поле с автоматически формируемым уникальным значением
- Дата и время
- Денежный тип
- Счетчик
- Логические данные
- OLE — содержит ссылку на внедряемые объекты, также не может быть ключевым или индексным
- Ссылка на другие объекты
- и т.д.

## Назначения свойств полей

- Подпись — может быть внедрена почти для всех видов полей, отображается как подпись к форме при создании форм и отчетов; <= 2048 символов
- Обязательное поле
- Формат поля — формат вывода данных в режиме таблицы
- Маска ввода — позволяет указать маску для ввода данных
- Размер поля — длина в символах
- Значение по умолчанию
- Условие назначения — позволяет разместить условия или назначения, в соответстие с которым будут проверяться данные
- Сообщение об ошибке
- Пустые строки
- Индексированное поле
- Ключевое поле


# Запросы
Запрос — вопрос о данных, хранящихся в таблице. Или инструкция на отбор записей, подлежащих изменению. Таким образом, они позволяют выбирать разные данные из таблиц по различным критериям, которые мы можем задавать. Также с помощью запросов можно формировать и выполнять вычисления формированием т.н. вычислительных полей. Также существует целая группа т.н. модифицирующих запросов, которые служат для модификации существующих таблиц.

В системе Access существуют следующие типы запросов:

- Запрос-выборка — вопрос о данных, хранящихся в таблицах, который представляет собой динамический набор данных в режиме таблицы или формы без их изменения
- Запрос-изменение — изменяет или перемещает данные в таблицах
	- Запросы на добавление
	- Запросы на удаление
	- Запрос на создание таблицы
	- Запрос на обновление таблицы
- Перекрестный запрос — группировка данных и представление их в компактном виде
- Запрос с параметрами — позволяет определить одно или несколько условий отбора данных во время выполнения запроса
- Запрос с вычислениями — позволяет сформировать вычисляемое поле и производить вычисления
- Запрос с условием — позволяет вводить условия на сортировку, группировку и т.д.
- Запрос SQL — тип запросов, который может быть создан с помощью инструкций языка SQL


# Формы
Форма — объект СУБД Access, в котором можно размещать элементы управления, предназначенные для ввода данных, вывода информации, изменения данных в полях, а также для наглядного отображения информации в базах данных. Формы строятся на основе таблиц или запросов.


# Отчеты
Отчет — объект, который позволяет представлять определенную информацию в итоговом виде. Максимально информативно оформляет итоговые документы форм, запросов, которые в перспективе могут быть выданы на печать, или сформированы в выходные документы на основе таблицы запросов.


# Макрос
Макрос — одна или несколько макрокоманд, которые можно применить или использовать для автоматизации какой-то отдельной операции или задачи. Макрос состоит из макрокоманд. Каждая макрокоманда является самостоятельной инструкцией, которая может быть объдинена с другими макрокомандами таким образом, что набор этих инструкций составляет тело макроса. Макрокоманды выбираются из списка, в котором располагается порядка сорока макрокоманд. Каждая макрокоманда имеет набор аргументов. В поле создания макроса имеется также специальный столбец для определения условия перехода на следующую макрокоманду.


# Модули
Набор описаний, инструкций и процедур, которые можно использовать для обработки данных и которые сохраняются под одним именем. В Microsoft Access имеется три типа модулей:

- Модули форм
- Модули отчетов
- Общий модуль — виден в структуре всей базы данных. Процедуры, используемые в этом модуле должны быть объявлены явным образом, иначе при появлении общих команд они распадаются на структуры, связанные с этими объектами.

Модули программируются на VBA. Также в них можно использовать готовые конструкции SQL и команды Access.


# Страницы
Предназначены для создания базы данных на сайтах сети и управления ими.



# Порядок разработки приложений в среде Access
Access позволяет нам использовать готовую пустую базу данных в прототипами различных объектов в ней (таблицы, запросы, модули, формы и т.д.). Используя эти прототипы мы можем сформировать любую конкретную базу данных. Кроме того, нам предоставляется набор мастеров, построитель выражений. Обязательной частью работы при создании базы данных остается следующее:

1. Проанализировать набор своих данных, которые мы планируем размещать в будущей базе
2. Определить логические взаимосвязи между этими данными
3. Определить структуру таблиц и типы данных в этих таблицах

После этого можно приступать к вводу данных, составлению запросов и уже на основе таблиц и запросов — к созданию форм с элементами управления.

Затем — разработать макросы и назначить их соответствующим элементам управления. В результате мы получаем набор связанных данных.


## Общая последовательность формирования базы данных
В общем случае, любая разработка начинается с общей постановки задачи, в которой определяется цель и назначение разработки, состав подзадач и последовательность их выполнения. Прежде чем создавать новую базу, необходимо ответить на следующие вопросы:

- Какую информацию вы намерены получить от базы данных
- На какие темы можно разделить информацию (как ее классифицировать)
- Как эти темы связываются друг с другом
- Какие сведения вы будете хранить по каждой придуманной теме
- Проанализировать содержание исходной информации и определить состав таблиц для разрабатываемой базы
- Определить структуру базы данных и связи между таблицами в ней
- Определить ключевые поля в таблицах и разработать схему связей между таблицами
- Разработать необходимые запросы и проверить их работу
- Разработать набор форм для просмотра и редактирования данных
- Разработать или выбрать элементы управления для каждой формы
- Разработать макросы для операций обработки данных и назначить их каждому выбранному элементу
- Разработать основную запускающую форму и обеспеить нужные связи между другими формами
- При необходимости разработать отчеты и модули в новой базе данных
- Проверить работу приложения в целом, при необходимости внести изменения и исправления в предыдущие пункты.



# Создание базы данных

## Создание и редактирование таблиц

- Текстовый тип — текстовые и числовые данные, не требующие проведения расчетов (255 знака, по умолчанию 50)
- Числовой — размещение числовых данных различных форматов для выполнения расчетов
- Дата и время — 100 — 9999 годы
- Денежный — ввод/вывод денежных данных
- MEMO
- Счетчик — создает специальное числовое поле, в котором подсчитывается уникальный порядковый номер каждой записи
- Логический тип данных
- OLE
- Гиперссылка — строчка, состоящая из букв, цифр, представляющих адрес гиперссылки
- Мастер подстановок

## Рекомендации по созданию нормализованных таблиц
- Каждое поле таблицы должно представлять уникальный тип информации, однозначно выбранный из предложенного списка
- Каждая таблица должна иметь уникальный идентификатор (первичный ключ)
- Для каждого значения первичного ключа значение столбца данных должны относиться к каждому объекту таблицы и полностью его описывать

## Установление взаимосвязей между таблицами
Для обеспечения целостности данных небходима разработка хорошо продуманных связей между полями данных таблиц.

Так как данные одной таблицы описывают реальный объект, то и связи между этими таблицами должны отражать существующие связи между этими объектами (однотипных объектов). Между таблицами существуют следующие типы связей:

- 1 к 1
- 1 ко многим
- многие ко многим

Правила:

- 1 к 1 устанавливается только между ключевыми полями таблиц
- 1 ко многим устанавливается с ключевым полем со стороны главной таблицы и неключевыми полями со стороны многие
- при организации связи многие ко многим требуется создание промежуточной таблицы, которая должна содержать по крайней мере два поля для задания значений связанных полей

Ограничения для связанных таблиц: если правильно установлена связь между таблицами, то произвольно изменить или удалить данные в связанных таблицах невозможно.



# Создание и редактирование запросов в Access
Создание в режиме конструктора и создание в режиме мастера.

## Запрос-выборка

## Запросы с вычислениями
В начале нужно указать наименование вычисляемого поля и отделяем его двоеточием. Создается первоначально из данных таблицы при помощи выборки, затем на пустом поле формируется вычисляемое поле, используя вычислитель — волшебная палочка. Если присутствует поле «групповая операция», то нужно выбрать эл-т выражения.

## Запрос с условиями отбора информации

## Запрос с параметрами
Запрос реализуется интерактивно. Для создания запроса с параметрами необходимо сперва создать запрос-выборку. В строке условия отбора указываем название параметра, заключенное в квадратные скобки.

## Перекрестный запрос
Для создания перекрестного запроса в режиме конструктора необходимо в меню выбрать опцию «запросы» -> «перекрестный запрос». В нижнем бланке запросов в выбранных полях в строчке «групповая операция» необходимо выбрать опцию «перекрестная таблица». Для полей, значения которых выводятся как заголовки столбцов, в ячейке «перекрестная таблица» выбирается «заголовки столбцов».




















